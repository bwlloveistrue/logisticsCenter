<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.logisticscenter.mapper.TruckGoodsOrderDao">
	<!-- 新增预录出车信息 -->
	<insert id="insertTruckGoodsOrderTaker" parameterType="truckGoodsOrderTakerEntity">
		insert into truckGoodsOrderTaker (
			goodsType,
			beginDate,
			client,
			deleteFlg,
			packageFlg,
			packagePrice,
			startPlace,
			endPlace,
			orderStatus,
			workPlace,
			createDate,
			createTime,
			editDate,
			editTime
		) 
		values 
		(
			#goodsType#,
			#beginDate#,
			#client#,
			#deleteFlg#,
			#packageFlg#,
			#packagePrice#,
			#startPlace#,
			#endPlace#,
			#orderStatus#,
			#workPlace#,
			#createDate#,
			#createTime#,
			#editDate#,
			#editTime#
		)
		<selectKey resultType="int" keyProperty="id" order="AFTER">
			SELECT max(id) as id from truckGoodsOrderTaker
		</selectKey>
	</insert>
	
	<!-- 新增预录出车详细信息 -->
	<insert id="insertTruckGoodsOrderDetail" parameterType="truckGoodsOrderDetailEntity">
		insert into truckGoodsOrderDetail (
			reportId,
			goodsType,
			deleteFlg,
			price,
			realCarry,
			invoiceFlg,
			startPlace,
			endPlace,
			createDate,
			createTime,
			editDate,
			editTime
		) 
		values 
		(
			#reportId#,
			#goodsType#,
			#deleteFlg#,
			#price#,
			#realCarry#,
			#invoiceFlg#,
			#startPlace#,
			#endPlace#,
			#createDate#,
			#createTime#,
			#editDate#,
			#editTime#
		)
		<selectKey resultType="int" keyProperty="id" order="AFTER">
			SELECT max(id) as id from truckGoodsOrderDetail
		</selectKey>
	</insert>
	
	
	<!-- 根据条件查询出车预录信息 -->
	<select id="getTruckGoodsOrderTaker" resultType="truckGoodsOrderTakerEntity" parameterType="truckGoodsOrderTakerEntity">
		select * from truckGoodsOrderTaker
		<where>
			<if test="id != null and id != ''">
				id = #{id}
			</if>
			<if test="client != null and client != ''">
				client = #{client}
			</if>
			<if test="orderStatus > 0">
				orderStatus = #{orderStatus}
			</if>
		</where>
	</select>
	
	<!-- 根据条件查询出车预录详细信息 -->
	<select id="getTruckGoodsOrderDetail" resultType="truckGoodsOrderDetailEntity" parameterType="truckGoodsOrderDetailEntity">
		select * from truckGoodsOrderDetail 

	</select>
	
	<!-- 根据reportID获得预录出车信息-->
	<select id="getTruckGoodsOrderDetailByReprotId" resultType="truckGoodsOrderDetailEntity">
		select * from truckGoodsOrderDetail where reportId in ($reportId$) and deleteFlg = 0 order by createdate desc,createtime desc
	</select>
	
   <!-- 删除预录信息 -->
	<update id="deleteTruckGoodsOrderTaker" parameterType="string">
		update truckGoodsOrderTaker set deleteFlg = 1 ,orderStatus =2 where id = #{id}
	</update>
	
	<!-- 删除预录详细信息 -->
	<update id="deleteTruckGoodsOrderDetail" parameterType="string">
		update truckGoodsOrderDetail set deleteFlg = 1  where id = #{id}
	</update>
   
   <!-- 更新预录出车信息 -->
   <update id="updateTruckGoodsOrderTaker" parameterType="truckGoodsOrderTakerEntity">
		update truckGoodsOrderTaker set 
			goodsType='$goodsType$',
			beginDate=#beginDate#,
			client=#client#,
			packageFlg=#packageFlg#,
			packagePrice=#packagePrice#,
			startPlace=#startPlace#,
			endPlace=#endPlace#,
			workPlace=#workPlace#,
			editDate=#editDate#,
			editTime=#editTime#
		 where id=#id#
   </update>
   
   <!-- 更新预录出车详细信息 -->
   <update id="updateTruckGoodsOrderDetail" parameterType="truckGoodsOrderDetailEntity">
		update truckGoodsOrderDetail set 
			goodsType=#goodsType#,
			price=#price#,
			realCarry=#realCarry#,
			invoiceFlg=#invoiceFlg#,
			startPlace=#startPlace#,
			endPlace=#endPlace#,
			editDate=#editDate#,
			editTime=#editTime#
		 where id=#id#
   </update>
   
   <!-- 更新预录出车详细信息 -->
   <update id="updateTruckGoodsOrderStatus" parameterType="truckGoodsOrderTakerEntity">
		update truckGoodsOrderTaker set 
			orderStatus=#orderStatus#,
			editDate=#editDate#,
			editTime=#editTime#
		 where id=#id#
   </update>
</mapper>